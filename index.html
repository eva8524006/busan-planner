<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Busan Trip</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #fff9fb; margin: 0; padding: 0; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        /* æ¢å¾©åŸæœ¬çš„ Banner ç…§ç‰‡ */
        .header-banner { 
            width: 100%; 
            height: 380px; 
            background-image: url('https://raw.githubusercontent.com/eva8524006/eva8524006.github.io/main/banner.jpg'); 
            background-size: cover; 
            background-position: center; 
            position: relative; 
        }

        .main-content { 
            margin-top: -40px; 
            border-radius: 40px 40px 0 0; 
            background: #fffefe; 
            min-height: 80vh; 
            padding: 24px; 
            position: relative; 
            box-shadow: 0 -15px 30px rgba(255, 182, 193, 0.2); 
        }

        /* å°èˆªæ¬„é¡è‰²èª¿æ•´ç‚ºæº«æŸ”çš„ç²‰è—è‰²èª¿ */
        .nav-container { 
            position: absolute; 
            bottom: 20px; 
            right: 20px; 
            display: flex; 
            gap: 10px; 
            background: rgba(255, 255, 255, 0.85); 
            backdrop-filter: blur(8px); 
            padding: 8px; 
            border-radius: 25px; 
            z-index: 30;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .tab-btn { transition: all 0.3s; display: flex; align-items: center; justify-content: center; width: 44px; height: 44px; border-radius: 15px; }
        .tab-btn.active { background-color: #7abaff; color: white; }
        .date-item.active { background: #7abaff; color: white; border-color: #7abaff; }
        
        /* å¡ç‰‡è¨­è¨ˆå„ªåŒ– */
        .trip-card {
            background: white;
            border: 1px solid #fdf2f5;
            box-shadow: 0 4px 12px rgba(255, 192, 203, 0.1);
        }
        
        .time-tag { background: #eef7ff; color: #5a96d4; padding: 2px 8px; border-radius: 8px; font-weight: 700; font-size: 11px; }
    </style>
</head>
<body>
    <div id="app" class="max-w-md mx-auto relative min-h-screen">
        
        <div class="fixed top-4 left-4 z-50">
            <button @click="exportData" class="bg-white/70 text-gray-600 text-[10px] px-3 py-2 rounded-full backdrop-blur-md flex items-center gap-2 border border-pink-100 shadow-sm">
                <i data-lucide="share-2" class="w-3 h-3 text-pink-400"></i> å‚™ä»½æ•¸æ“š
            </button>
        </div>

        <header class="header-banner">
            <div class="nav-container">
                <button @click="currentTab = 'itinerary'" :class="['tab-btn', currentTab==='itinerary'?'active':'text-gray-400']"><i data-lucide="map-pin"></i></button>
                <button @click="currentTab = 'info'" :class="['tab-btn', currentTab==='info'?'active':'text-gray-400']"><i data-lucide="info"></i></button>
                <button @click="currentTab = 'shop'" :class="['tab-btn', currentTab==='shop'?'active':'text-gray-400']"><i data-lucide="shopping-basket"></i></button>
                <button @click="currentTab = 'cost'" :class="['tab-btn', currentTab==='cost'?'active':'text-gray-400']"><i data-lucide="wallet"></i></button>
            </div>
        </header>

        <main class="main-content pb-32">
            <div v-show="currentTab === 'itinerary'">
                <div class="flex overflow-x-auto gap-3 no-scrollbar mb-6 py-2">
                    <div v-for="d in dates" :key="d.id" @click="selectedDate = d.id" :class="['date-item flex-shrink-0 w-16 h-20 rounded-3xl border flex flex-col items-center justify-center cursor-pointer shadow-sm transition-all', selectedDate === d.id ? 'active' : 'bg-white text-gray-300 border-gray-50']">
                        <span class="text-[10px] font-bold uppercase mb-1">{{ d.week }}</span>
                        <span class="text-xl font-bold font-mono">{{ d.day }}</span>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div v-for="item in sortedItinerary" :key="item.id" class="trip-card p-4 rounded-[1.8rem] flex gap-4 items-center">
                        <div class="p-3 rounded-2xl bg-pink-50 text-pink-400"><i :data-lucide="item.icon || 'map-pin'" class="w-5 h-5"></i></div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start">
                                <div>
                                    <span v-if="item.time" class="time-tag mb-1 inline-block">{{ item.time }}</span>
                                    <h3 class="font-bold text-gray-700 text-sm leading-tight">{{ item.name }}</h3>
                                </div>
                                <div class="flex gap-1">
                                    <button v-if="item.location" @click="openMap(item.location)" class="text-blue-400 p-2 rounded-full hover:bg-blue-50"><i data-lucide="map" class="w-4 h-4"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'shop'" class="space-y-4">
                <h2 class="font-black text-2xl mb-4 text-gray-700 flex items-center gap-2">
                    <span class="text-pink-300">ğŸŒ¸</span> Shopping List
                </h2>
                <div v-for="item in db.shop" :key="item.id" class="flex items-center gap-3 bg-white p-4 rounded-2xl border border-pink-50 shadow-sm">
                    <input type="checkbox" v-model="item.done" class="w-6 h-6 rounded-full accent-pink-400">
                    <p :class="{'line-through opacity-30': item.done}" class="flex-1 font-bold text-gray-600">{{ item.name }}</p>
                </div>
            </div>
            
            </main>

        <button @click="openAddModal" class="fixed bottom-8 right-8 w-16 h-16 bg-pink-300 text-white rounded-full shadow-2xl flex items-center justify-center z-40 border-4 border-white">
            <i data-lucide="plus" class="w-8 h-8"></i>
        </button>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, watch } = Vue;
        createApp({
            setup() {
                const DB_KEY = 'busan_trip_data_v2';
                // é€™è£¡æ”¾å…¥ä½ çš„ JSON æ•¸æ“š
                const db = ref(JSON.parse(localStorage.getItem(DB_KEY)) || { itinerary: [], shop: [], cost: [] });
                const currentTab = ref('itinerary');
                const selectedDate = ref('4/10');
                const dates = [{id:'4/10',week:'FRI',day:'10'},{id:'4/11',week:'SAT',day:'11'},{id:'4/12',week:'SUN',day:'12'}];

                const sortedItinerary = computed(() => {
                    return db.value.itinerary.filter(i => i.date === selectedDate.value)
                        .sort((a,b) => (a.time||'99:99').localeCompare(b.time||'99:99'));
                });

                const openMap = (loc) => { if(loc) window.open(loc.startsWith('http') ? loc : `https://www.google.com/maps/search/${encodeURIComponent(loc)}`, '_blank'); };
                const exportData = () => { navigator.clipboard.writeText(JSON.stringify(db.value)).then(() => alert('æ•¸æ“šå·²è¤‡è£½')); };

                onMounted(() => { lucide.createIcons(); });
                watch([currentTab, selectedDate], () => { setTimeout(() => lucide.createIcons(), 10); });

                return { currentTab, selectedDate, dates, db, sortedItinerary, openMap, exportData };
            }
        }).mount('#app');
    </script>
</body>
</html>
