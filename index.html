<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Busan Trip</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans TC', 'Inter', sans-serif; background-color: #f8fafc; margin: 0; padding: 0; touch-action: pan-y; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        /* ÊîπËâØÂæåÁöÑ Header */
        .header-banner { 
            width: 100%; 
            height: 350px; 
            background-image: url('https://images.unsplash.com/photo-1570191913384-7b3ff11822be?q=80&w=2000&auto=format&fit=crop'); 
            background-size: cover; 
            background-position: center; 
            position: relative; 
        }
        .header-overlay { 
            position: absolute; 
            inset: 0; 
            background: linear-gradient(to top, rgba(248,250,252,1) 0%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.4) 100%); 
        }

        .main-content { margin-top: -60px; border-radius: 40px 40px 0 0; background: #f8fafc; min-height: 80vh; padding: 24px; position: relative; }
        
        .nav-container { 
            position: absolute; 
            bottom: 80px; 
            right: 24px; 
            display: flex; 
            gap: 8px; 
            background: rgba(255,255,255,0.9); 
            backdrop-filter: blur(10px); 
            padding: 6px; 
            border-radius: 22px; 
            z-index: 30;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        
        .tab-btn { transition: all 0.3s; display: flex; align-items: center; justify-content: center; width: 44px; height: 44px; border-radius: 16px; }
        .tab-btn.active { background-color: #3b82f6; color: white; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4); }
        
        .date-item.active { background: #3b82f6; color: white; border-color: #3b82f6; transform: scale(1.05); }
        .time-tag { background: #eff6ff; color: #3b82f6; padding: 2px 8px; border-radius: 8px; font-family: 'Inter', monospace; font-weight: 700; font-size: 11px; }
        
        /* È£õË°åÂç°ÁâáÊ®£Âºè */
        .flight-card {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-left: 4px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div id="app" class="max-w-md mx-auto relative min-h-screen">
        
        <div class="fixed top-4 left-4 z-50">
            <button @click="exportData" class="bg-black/60 text-white text-[10px] px-4 py-2 rounded-full backdrop-blur-md flex items-center gap-2 border border-white/20 hover:bg-black/80 transition-all">
                <i data-lucide="share-2" class="w-3 h-3"></i> ÂêåÊ≠•ÊúÄÊñ∞Ë≥áÊñô
            </button>
        </div>

        <header class="header-banner">
            <div class="header-overlay"></div>
            <div class="absolute bottom-[110px] left-8 z-10">
                <p class="text-[12px] font-bold text-blue-500 tracking-[0.4em] uppercase mb-1">Spring 2025</p>
                <h1 class="text-5xl font-black text-slate-800 uppercase tracking-tighter">Busan Trip</h1>
            </div>
            
            <div class="nav-container">
                <button @click="currentTab = 'itinerary'" :class="['tab-btn', currentTab==='itinerary'?'active':'text-gray-400']"><i data-lucide="calendar"></i></button>
                <button @click="currentTab = 'info'" :class="['tab-btn', currentTab==='info'?'active':'text-gray-400']"><i data-lucide="plane"></i></button>
                <button @click="currentTab = 'shop'" :class="['tab-btn', currentTab==='shop'?'active':'text-gray-400']"><i data-lucide="shopping-bag"></i></button>
                <button @click="currentTab = 'cost'" :class="['tab-btn', currentTab==='cost'?'active':'text-gray-400']"><i data-lucide="wallet"></i></button>
            </div>
        </header>

        <main class="main-content pb-32">
            <div v-show="currentTab === 'itinerary'">
                <div class="flex overflow-x-auto gap-3 no-scrollbar mb-8 py-2">
                    <div v-for="d in dates" :key="d.id" @click="selectedDate = d.id" :class="['date-item flex-shrink-0 w-16 h-20 rounded-[2rem] border flex flex-col items-center justify-center cursor-pointer shadow-sm transition-all', selectedDate === d.id ? 'active' : 'bg-white text-gray-400 border-gray-100']">
                        <span class="text-[10px] font-bold uppercase mb-1">{{ d.week }}</span>
                        <span class="text-xl font-black font-mono">{{ d.day }}</span>
                    </div>
                </div>

                <div class="space-y-4">
                    <div v-for="item in sortedItinerary" :key="item.id" class="bg-white p-5 rounded-[2rem] border border-gray-50 shadow-sm flex gap-4 items-center hover:border-blue-200 transition-colors">
                        <div class="p-4 rounded-2xl bg-blue-50 text-blue-500 shadow-inner"><i :data-lucide="item.icon || 'map-pin'" class="w-5 h-5"></i></div>
                        <div class="flex-1" @click="openEditModal(item)">
                            <div class="flex justify-between items-start">
                                <div>
                                    <span v-if="item.time" class="time-tag mb-1.5 inline-block">{{ item.time }}</span>
                                    <h3 class="font-bold text-gray-800 text-base leading-tight">{{ item.name }}</h3>
                                </div>
                                <div class="flex gap-1">
                                    <button v-if="item.location" @click.stop="openMap(item.location)" class="text-blue-500 bg-blue-50 p-2.5 rounded-full"><i data-lucide="map" class="w-4 h-4"></i></button>
                                    <button @click.stop="deleteItem('itinerary', item.id)" class="text-gray-300 p-2.5 hover:text-red-400 transition-colors"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'info'" class="space-y-6">
                <div class="flight-card p-6 rounded-[2.5rem] text-white shadow-xl relative overflow-hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-black text-lg tracking-widest flex items-center gap-2 uppercase">
                            <i data-lucide="plane" class="w-5 h-5 text-blue-400"></i> Flight Info
                        </h3>
                        <span class="text-[10px] bg-blue-500 px-2 py-1 rounded-md font-bold">ECONOMY</span>
                    </div>
                    
                    <div class="space-y-6">
                        <div class="flex justify-between items-center border-b border-white/10 pb-4">
                            <div class="text-left">
                                <p class="text-[10px] text-gray-400 font-bold uppercase">4/10 TPE</p>
                                <p class="text-2xl font-black">02:50</p>
                            </div>
                            <div class="flex flex-col items-center flex-1 px-4">
                                <i data-lucide="move-right" class="w-4 h-4 text-blue-400"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-[10px] text-gray-400 font-bold uppercase">BUSAN PUS</p>
                                <p class="text-2xl font-black">06:10</p>
                            </div>
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="text-left">
                                <p class="text-[10px] text-gray-400 font-bold uppercase">4/12 PUS</p>
                                <p class="text-2xl font-black">20:45</p>
                            </div>
                            <div class="flex flex-col items-center flex-1 px-4">
                                <i data-lucide="move-right" class="w-4 h-4 text-blue-400"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-[10px] text-gray-400 font-bold uppercase">TAIPEI TPE</p>
                                <p class="text-2xl font-black">22:10</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-[2.5rem] border border-gray-100 shadow-sm">
                    <h3 class="font-bold text-gray-800 flex items-center gap-2 mb-4">
                        <i data-lucide="bed-double" class="w-5 h-5 text-blue-500"></i> Hotel Reservation
                    </h3>
                    <div class="p-4 bg-slate-50 rounded-3xl mb-4">
                        <p class="text-xl font-black text-gray-800">Stanford Busan Hotel</p>
                        <p class="text-xs text-gray-400 mt-1 flex items-center gap-1">
                            <i data-lucide="map-pin" class="w-3 h-3"></i> Nampo-dong, Busan
                        </p>
                    </div>
                    <button @click="openMap('https://www.booking.com/hotel/kr/stanford-inn-busan.zh-tw.html')" 
                            class="w-full bg-blue-500 text-white py-4 rounded-2xl font-black flex items-center justify-center gap-2 shadow-lg shadow-blue-100 hover:bg-blue-600 transition-all">
                        <i data-lucide="external-link" class="w-4 h-4"></i> Booking Details
                    </button>
                </div>
            </div>

            <div v-if="currentTab === 'shop'" class="space-y-4">
                <div class="flex justify-between items-end mb-4">
                    <h2 class="font-black text-3xl text-gray-800">Shopping</h2>
                    <span class="text-xs font-bold text-blue-500 bg-blue-50 px-3 py-1 rounded-full">{{ db.shop.filter(s => s.done).length }}/{{ db.shop.length }}</span>
                </div>
                <div v-for="item in db.shop" :key="item.id" class="flex items-center gap-4 bg-white p-5 rounded-3xl border border-gray-100 transition-all" :class="{'opacity-60': item.done}">
                    <input type="checkbox" v-model="item.done" @change="saveData" class="w-6 h-6 rounded-full border-2 border-blue-500 text-blue-500 focus:ring-blue-500 transition-all">
                    <p :class="{'line-through': item.done}" class="flex-1 font-bold text-gray-700 text-lg">{{ item.name }}</p>
                    <button @click="deleteItem('shop', item.id)" class="text-gray-200 hover:text-red-400"><i data-lucide="x" class="w-5 h-5"></i></button>
                </div>
            </div>

            <div v-if="currentTab === 'cost'" class="space-y-4">
                <div class="bg-slate-900 p-10 rounded-[3rem] text-white shadow-2xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-8 opacity-10"><i data-lucide="wallet" class="w-32 h-32"></i></div>
                    <p class="text-[10px] opacity-50 font-bold uppercase tracking-[0.3em] mb-2 text-blue-400">Total Budget</p>
                    <p class="text-4xl font-black mb-1">Ready!</p>
                    <p class="text-sm text-gray-400">Enjoy your trip in Busan</p>
                </div>
            </div>
        </main>

        <button @click="openAddModal" class="fixed bottom-8 right-8 w-16 h-16 bg-blue-500 text-white rounded-full shadow-2xl flex items-center justify-center z-40 border-4 border-white active:scale-90 transition-transform">
            <i data-lucide="plus" class="w-8 h-8"></i>
        </button>

        <div v-if="showModal" class="fixed inset-0 z-50 bg-black/60 backdrop-blur-md flex items-end justify-center">
            <div class="bg-white w-full max-w-md rounded-t-[3.5rem] p-10 max-h-[90vh] overflow-y-auto shadow-2xl transition-all translate-y-0">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-black text-gray-800">Á∑®ËºØÈ†ÖÁõÆ</h3>
                    <button @click="showModal = false" class="bg-gray-100 p-2 rounded-full text-gray-400"><i data-lucide="x"></i></button>
                </div>
                <div class="space-y-6">
                    <div>
                        <label class="text-[10px] font-black text-gray-400 block mb-2 uppercase tracking-widest">È†ÖÁõÆÂêçÁ®±</label>
                        <input v-model="form.name" type="text" class="w-full border-b-2 border-gray-100 py-3 outline-none font-bold text-xl focus:border-blue-500 transition-colors">
                    </div>
                    <div>
                        <label class="text-[10px] font-black text-gray-400 block mb-2 uppercase tracking-widest">Âú∞ÂúñÈÄ£Áµê / Âú∞Èªû</label>
                        <input v-model="form.location" type="text" placeholder="https://..." class="w-full border-b-2 border-gray-100 py-3 outline-none text-blue-600 text-sm focus:border-blue-500 transition-colors">
                    </div>
                    <div class="flex gap-6">
                        <div class="flex-1">
                            <label class="text-[10px] font-black text-gray-400 block mb-2">ÊôÇÈñì</label>
                            <input v-model="form.time" type="time" class="w-full border-b-2 border-gray-100 py-3 outline-none font-bold">
                        </div>
                        <div class="flex-1">
                            <label class="text-[10px] font-black text-gray-400 block mb-2">ÂúñÊ®ô</label>
                            <select v-model="form.icon" class="w-full border-b-2 border-gray-100 py-3 outline-none bg-transparent">
                                <option value="map-pin">ÊôØÈªû</option>
                                <option value="utensils">È§êÈ£≤</option>
                                <option value="shopping-cart">Ë≥ºÁâ©</option>
                                <option value="coffee">ÂíñÂï°Âª≥</option>
                                <option value="plane">‰∫§ÈÄö</option>
                                <option value="sparkles">‰∫ÆÈªû</option>
                            </select>
                        </div>
                    </div>
                </div>
                <button @click="handleSave" class="w-full bg-blue-500 text-white py-5 rounded-[2rem] mt-10 font-black shadow-lg shadow-blue-100 active:scale-95 transition-all">Á¢∫Ë™çÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, watch, nextTick } = Vue;

        createApp({
            setup() {
                const DB_KEY = 'busan_vFinal_2025_Full_Sync';
                const currentTab = ref('itinerary');
                const selectedDate = ref('4/10');
                const showModal = ref(false);
                const isEditing = ref(false);
                const editingId = ref(null);
                const form = ref({ name: '', location: '', icon: 'map-pin', time: '' });

                const initialData = {
                  "itinerary": [
                    { "id": 101, "date": "4/10", "time": "02:50", "name": "Ê°ÉÂúíÊ©üÂ†¥ TPE", "icon": "plane", "location": "TPE" },
                    { "id": 102, "date": "4/10", "time": "06:10", "name": "ÈáúÂ±±Ê©üÂ†¥ PUS", "icon": "map-pin", "location": "PUS" },
                    { "id": 103, "date": "4/10", "time": "09:00", "name": "ÎèôÏÇºÌï¥ÏàòÏ≤ú (ÂΩ±Â≥∂Ë≥ûÊ´ª üå∏)", "icon": "sparkles", "location": "https://naver.me/GDTEaA1g" },
                    { "id": 104, "date": "4/10", "time": "12:00", "name": "ËûûËüªÂÆ∂Ëæ£ÁÇíÁ´†È≠ö ÂçóÊµ¶Ê¥û", "icon": "utensils", "location": "https://naver.me/FmG8sKRg" },
                    { "id": 105, "date": "4/10", "time": "13:00", "name": "Olive Young", "icon": "shopping-cart", "location": "Olive Young" },
                    { "id": 106, "date": "4/10", "time": "14:00", "name": "Gukje Pharmacy ÂúãÈöõËó•Êàø", "icon": "shopping-cart", "location": "https://naver.me/FgEema7r" },
                    { "id": 201, "date": "4/11", "time": "11:00", "name": "Êµ∑Èõ≤Âè∞ Busan butter sand", "icon": "shopping-cart", "location": "https://naver.me/GdTEaA1g" },
                    { "id": 205, "date": "4/11", "time": "12:00", "name": "Ê∞¥ÈÇäÊúÄÈ´òË±¨ËÇâÊπØÈ£Ø", "icon": "utensils", "location": "ÏàòÎ≥ÄÏµúÍ≥†ÎèºÏßÄÍµ≠Î∞•" },
                    { "id": 301, "date": "4/12", "time": "09:00", "name": "Êú¨Á≤• ÈÆëÈ≠öÁ≤•", "icon": "utensils", "location": "https://naver.me/G0p9FCo0" },
                    { "id": 306, "date": "4/12", "time": "20:45", "name": "ÈáúÂ±±ÈáëÊµ∑Ê©üÂ†¥", "icon": "plane", "location": "PUS" }
                  ],
                  "shop": [
                    { "id": 501, "name": "The North Face", "done": false },
                    { "id": 502, "name": "Busan butter sand", "done": false },
                    { "id": 503, "name": "ËúÇËúú‰∫∫ËîòÁâá", "done": false },
                    { "id": 506, "name": "Object ÁüÆË¢ãÈº†", "done": false },
                    { "id": 507, "name": "Ê®ÇÂ§©Ë∂ÖÂ∏Ç", "done": false }
                  ],
                  "cost": []
                };

                const db = ref(JSON.parse(localStorage.getItem(DB_KEY)) || initialData);
                const dates = [
                    {id:'4/10',week:'Fri',day:'10'},
                    {id:'4/11',week:'Sat',day:'11'},
                    {id:'4/12',week:'Sun',day:'12'}
                ];
                
                const sortedItinerary = computed(() => {
                    return db.value.itinerary.filter(i => i.date === selectedDate.value).sort((a,b) => (a.time||'99:99').localeCompare(b.time||'99:99'));
                });

                const refreshIcons = () => nextTick(() => { if(window.lucide) window.lucide.createIcons(); });
                const saveData = () => { localStorage.setItem(DB_KEY, JSON.stringify(db.value)); refreshIcons(); };

                const exportData = () => {
                    const dataStr = JSON.stringify(db.value, null, 2);
                    navigator.clipboard.writeText(dataStr).then(() => alert('ÊúÄÊñ∞Ë≥áÊñôÂ∑≤Ë§áË£ΩÔºåÂèØ‰ª•Ë≤ºÁµ¶ AI Êõ¥Êñ∞ÂõâÔºÅ'));
                };

                const openAddModal = () => {
                    isEditing.value = false;
                    form.value = { name: '', location: '', icon: 'map-pin', time: '' };
                    showModal.value = true;
                };

                const openEditModal = (item) => {
                    isEditing.value = true; editingId.value = item.id;
                    form.value = { ...item }; showModal.value = true;
                };

                const handleSave = () => {
                    if(!form.value.name) return;
                    const target = currentTab.value === 'itinerary' ? db.value.itinerary : db.value.shop;
                    if(isEditing.value) {
                        const idx = target.findIndex(i => i.id === editingId.value);
                        if(idx !== -1) target[idx] = { ...form.value, id: editingId.value };
                    } else {
                        target.push({ ...form.value, id: Date.now(), date: selectedDate.value, done: false });
                    }
                    saveData(); showModal.value = false;
                };

                const deleteItem = (type, id) => {
                    if(confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãÈ†ÖÁõÆÂóéÔºü')) {
                        db.value[type] = db.value[type].filter(i => i.id !== id);
                        saveData();
                    }
                };

                const openMap = (loc) => {
                    if(!loc || loc === 'TPE' || loc === 'PUS') return;
                    window.open(loc.startsWith('http') ? loc : `https://www.google.com/maps/search/${encodeURIComponent(loc)}`, '_blank');
                };

                onMounted(() => refreshIcons());
                watch([currentTab, selectedDate, showModal], () => refreshIcons());

                return { currentTab, selectedDate, dates, db, sortedItinerary, showModal, form, exportData, openAddModal, openEditModal, handleSave, deleteItem, openMap, saveData };
            }
        }).mount('#app');
    </script>
</body>
</html>
